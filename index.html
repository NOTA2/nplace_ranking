<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nPlace-Ranking</title>
</head>
<body>
    <h1>nPlace-Ranking</h1>
    <div id="result"></div>

    <script>
        function loadItem() {
            return fetch('./json/엘바노헤어.json')
                .then((response) => response.json())
        }

        // 0을 추가하는 보조 함수입니다.
        function addZero(num) {
            return (num < 10 ? '0' : '') + num;
        }

        function getFormattedDate(d) {
            return d.getFullYear() + '-' + 
                addZero((d.getMonth() + 1)) + '-' + 
                addZero(d.getDate()) + ' ' + 
                addZero(d.getHours()) + ':' + 
                addZero(d.getMinutes()) + ':' + 
                addZero(d.getSeconds());
        }

        function getRanking(keyword) {
            return keyword.map(k => `
                <li>키워드 : ${k.name}</li>
                <ul>
                    <li>데이터 순위 : ${k.dataRank ? k.dataRank + '위' : '20위 밖🥲'}</li>
                    <li>광고를 포함한 노출 순위 : ${k.viewRankWithAd ? k.viewRankWithAd + '위' : '20위 밖🥲'}</li>
                    <li>키워드 광고 갯수 : ${k.viewAdCount}건</li>
                </ul>
            `).join('')
        }

        function displayItem(result) {
            const container = document.getElementById('result');

            container.innerHTML = `
                <h2>내 가게 : ${result.myPlace}</h2>
                <h3>업데이트 시각 : ${getFormattedDate(new Date(result.lastUpdateTime))}</h3>
                <ul>
                    ${getRanking(result.keyword)}
                </ul>
            `
        }

        loadItem().then(result => {
            displayItem(result)
        })
    </script>
</body>
</html>